{% extends "base.html" %}
{% load materializecss %}
{% load staticfiles %}
{% block title %} | Tickets{% endblock %}
{% block css %}
<style>
	body {
		background: url("{% static 'img/bg-03.png' %}") no-repeat center center fixed;
		background-size: cover;
	}
</style>
{% endblock %}

{% block content %}

{% if user.is_authenticated %}
<a href="{% url 'tickets_new_bug' %}" class="btn btn-large green text-shadow-2">
	New Bug
	<i class="fas fa-bug fa-lg" aria-hidden="true"></i>
</a>

<a href="{% url 'tickets_new_feature' %}" class="btn btn-large green text-shadow-2">
	New Feature
	<i class="fas fa-magic fa-lg" aria-hidden="true"></i>
</a>
{% endif %}
<br><br>

<div class="row">

	<!-- Ticket Cards -->
	{% for ticket in tickets %}
	<a href="{% url 'tickets_view_one' ticket.id %}">
		<div class="col s12 m6">
			<div class="card form bold white-text text-shadow-2 hoverable">

				<div class="card-badge-div">
					<!-- Ticket Status (Open | In Progress | Closed) -->
					<span class="card-badge card-badge-{% include 'partials/status_color.html' %}">
						<!-- Ticket Type (Bug vs Feature) -->
						{% if ticket.ticket_type == "Bug" %}
							<i class="fas fa-bug fa-lg" aria-hidden="true"></i>
						{% elif ticket.ticket_type == "Feature" %}
							<i class="fas fa-magic fa-lg" aria-hidden="true"></i>
						{% endif %}
					</span>
				</div>

				<!-- Ticket Title & Description -->
				<span class="{% include 'partials/status_color.html' %}-text">
					<div class="card-content">
						<h6 class="bold">
							<span class="white-text">{{ ticket.ticket_type | upper }}</span>
							({{ ticket.ticket_status }})
						</h6>
						<div class="divider"></div>
						<br>
						<span class="card-title truncate">
							{{ ticket.title }}
						</span>
						<p class="truncate">
							<i class="fas fa-info-circle white-text" title="{{ ticket.description }}"></i>
							{{ ticket.description }}
						</p>
					</div>
				</span>

				<!-- Ticket Stats -->
				<div class="card-action {% include 'partials/status_color.html' %} darken-5">
					<div class="row center-align">
						<div class="col s4 tooltipped" data-position="top" data-tooltip="UPVOTES">
							<i class="far fa-thumbs-up fa-lg" aria-hidden="true"></i><br>
							<span class="white-text">{{ ticket.upvotes }}</span>
						</div>
						<div class="col s4 tooltipped" data-position="top" data-tooltip="VIEWS">
							<i class="far fa-eye fa-lg" aria-hidden="true"></i><br>
							<span class="white-text">{{ ticket.views }}</span>
						</div>
						{% if ticket.ticket_type == "Feature" %}
						<div class="col s4 tooltipped" data-position="top" data-tooltip="DONATED">
							<i class="fas fa-hand-holding-usd fa-lg" aria-hidden="true"></i><br>
							<span class="white-text">
							&euro;{{ ticket.gross_total }}
							</span>
						</div>
						{% else %}
						FREE<br>UPVOTES
						{% endif %}
					</div>
				</div>

			</div>
		</div>
	</a>
	{% empty %}
	<h1 class="white-text">
		There aren't any tickets currently!
	</h1>
	{% endfor %}

</div>

{% endblock %}
